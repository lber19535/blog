---
title:        "自定义 View"
date:         2016-05-29 17:00
categories:   Android
list_number:  false
tags:
- Android
---

在看了官方文档的[自定义 View](https://developer.android.com/training/custom-views/index.html)之后决定写一个比较详细的东西来记录这个学习过程。这篇文章会先从 View 的工作流程以及和 Activity 之间的关系说起，然后对常用的绘制工具（Matrix，Rect，Paint，Drawable，Bitmap，Canvas 等）做一些简单的介绍，最后写一个自定义的布局和一个自定义的 View。

<!--more-->
## 1.Activity 与 View 
首先 Activity 既不是 View 也不是 Window，其次 Activity 和 Window 还有 View 之间的关系可以简单的理解为下图：

![](http://7xisp0.com1.z0.glb.clouddn.com/activity_view_ship.png)

看起来就像是俄罗斯套娃，最终我们在 Activity 中使用 setContentView 的时候实际上是 decorview 将我们传入的 layout 放到了 contentview 这个地方。另外 Activity 和 View 之间有联系的是触摸事件，由于之前写过一篇比较详细的触摸事件分析的[文章](http://lber19535.github.io/2015/04/27/2015-2015-04-27-Android%E8%A7%A6%E6%91%B8%E7%B3%BB%E7%BB%9F/)，这里就不展开说了。

以上差不多就是 Activity 和 View 之间的一个简单的关系，更为详细的内容在自定义 View 里用不到，感兴趣的可以到参考部分看下。

## 2.View 和 ViewGroup
View 和 ViewGroup 大家再熟悉不过了，其中 ViewGroup 继承自 View，添加了一些对子 View 管理的方法，例如 addView。当一个 View 被 add 到一个 ViewGroup 上的时候会经过下面这个流程：
![](http://i.stack.imgur.com/MDJXT.png)
图片来源：[Google +](https://plus.google.com/+ArpitMathur/posts/cT1EuBbxEgN)








## 参考：
[Android应用程序窗口（Activity）的窗口对象（Window）的创建过程分析](http://blog.csdn.net/luoshengyang/article/details/8223770)
[窗口机制分析与UI管理系统](http://www.cnblogs.com/lcw/p/3372914.html)