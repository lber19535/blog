---
title:        "Android 触摸系统"
date:         2015-4-27 17:00
categories:   Android
tags:
- Android
- Framework
---

[Mastering The Android Touch System][1] 学习笔记。

<!--more-->

## 1. 概述

### 1.1 Android 是如何处理触摸事件的

每一个触摸事件都会被系统封装成一种 [MotionEvent][2]，MotionEvent提供了触摸的所有信息，例如位置、时间、几个手指触发的等。系统提供了一些常见的事件类型：

|       事件               |          说明              |
|:------------------------|:---------------------------|
|   ACTION_DOWN            |  手指按下，一个手势的开始      |
|   ACTION_UP              |  手指抬起，一个手势的结束      |
|   ACTION_MOVE            |  手指在屏幕上移动            |
|   ACTION_POINTER_DOWN    |  第二根手指或更多的手指按下（多点触控会用到）    |
|   ACTION_POINTER_UP      |  第二根手指或更多的手指按下（多点触控会用到）    |
|   ACTION_CANCEL          |  触摸事件由当前View传到了另一个VIew则会触发cancel |

### 1.2 触摸事件是如何传递的

事件由底层硬件和驱动产生，然后最先被传递到当前活动的 Activity 中，通过 dispatchTouchEvent() 方法来分发触摸事件。不建议在 Activity 的 dispatchTouchEvent 方法中添加过多的对事件处理的逻辑，但是可以添加一些对当前事件走向的检测。

之后触摸事件被传递到 ViewGroups 或者 ViewGroup 的子 View 中，在这个过程中，可以随时拦截下事件的传递。

整个传递的过程大概是这样的：

![event_1](http://7xisp0.com1.z0.glb.clouddn.com/touch_event_system_simple.png)
```seq
Activity->RootView: dispatchTouchEvent()
RootView->ChildView: dispatchTouchEvent()

ChildView->RootView: onTouchEvent()
RootView->Activity: onTouchEvent()
```




















[1]:http://v.youku.com/v_show/id_XODQ1MjI2MDQ0.html
[2]:http://developer.android.com/reference/android/view/MotionEvent.html