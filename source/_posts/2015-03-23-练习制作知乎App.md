---
title:        "练习制作APP"
date:         2015-3-23 17:00
categories:   Android
tags：
- Android
- Custom View
- Demo
---

## 1. 前言

出于希望对Android app开发有更深入的了解的目的，决定自己制作一个APP，选取的目标是平时比较常用的知乎app。为了方便，所有的数据获取采用模拟浏览器操作来获取（POST，GET请求），得到的数据有的是html和json两种。这篇blog用来记录这个app从无到有经历的过程，包括遇到的问题，对问题的思考等方面。

<!--more-->

## 2. 准备

### 2.1 网络
网络框架使用[Volley][1]，它对HttpURLConnection和HttpClient进行了适当的封装，使用回调函数处理Response，便捷的图片加载以及很强的可扩展性。
在做这个app的时候由于是要模拟浏览器行为，所以对request定制了UA，对httpclient定制了可以持久化的cookiestore，同时由于同一个cookie不能被多线程操作，所以又将Volley的线程池size设置为1，同时为了方便使用将Volley做成了单例，并且根据不同的接口封装了不同的回调方法，不同的接口中增加了对response返回值的处理，更方便在UI上方便使用。
JSON的解析使用自己写的Jeson工具，通过注解实现对对象和json之间的互相转化。
HTML的解析打算仿照Jeson写一个通过注解xpath配合jsoup来解析html文件。

### 2.2 缓存
* **文件**
[Volley][1]自带缓存[DiskBasedCache][2]，通过Dispatcher需要cache的请求，将数据持久化。
* **cookie**
实现一个将cookie存到SharedPreference中的CookieStore。
* **数据库**
timeline的数据缓存到数据库中，当内存不足时，避免重新载入。

### 2.3 数据库

### 2.4 UI
UI整体参考了官方的[Material Design][3],使用了一些v7包中的兼容控件

#### 2.4.1 RecyclerView

#### 2.4.2 Toolbar

#### 2.4.3 SwipeRefreshLayout

#### 2.4.4 CardView

#### 2.4.5 Palette 














<!--
app的一些想法：
1.timeline加入 + 圆形按钮，提供主题切换，返回最上层的功能。同时上滑隐藏，下滑出现。
2.要加入对5.0特效的支持
3.ForegroundColorSpan
-->


<!--Volley-->
[1]: http://developer.android.com/training/volley/index.html
<!--DiskBasedCache-->
[2]: https://android.googlesource.com/platform/frameworks/volley/+/android-5.1.0_r1/src/com/android/volley/toolbox/DiskBasedCache.java
<!--Material Design-->
[3]:http://www.google.com/design/spec/material-design
<!--RecyclerView-->
[4]:https://developer.android.com/reference/android/support/v7/widget/RecyclerView.html
<!--Toolbar-->
[5]:https://developer.android.com/reference/android/support/v7/widget/Toolbar.html
<!--SwipeRefreshLayout-->
[6]:https://developer.android.com/reference/android/support/v4/widget/SwipeRefreshLayout.html
